# C4 Diagrams

> Generated by CoPilot, modified to be more accurate.

## System Context


The diagram below shows the System Context (C1) for the SAPPub project: primary users, system boundaries, and external systems the project interacts with.

```mermaid
graph LR
	%% People
	A["End User (Browser)"] -->|uses| SAPPubWeb["SAPPub Web\n(ASP.NET Core)"]
	B["Data Upserter (Dev/ GitHub Action)"] -->|manages / config| SAPPubWeb

	%% System internal
	SAPPubWeb --> Core["SAPPub Core\n(Business logic)"]
	Core -->|reads/writes| DB[("Database\n(SQL)")]

	%% External systems
	Core -->|imports data from| SAPDataTool["SAP Data Importer\n(SAPData project / ETL)"]
	SAPDataTool -->|pushes SQL / files| DB
	Core -->|calls| ExternalAPI["External Services\n(3rd-party APIs)"]

	%% Notes
	classDef system fill:#f8f9fa,stroke:#2b8aef;
	class SAPPubWeb,Core system
```

Summary (at-a-glance):

- Primary users: `End User` (site visitors) and `Data Upserter` (Dev/ Github Action).
- In-scope system: `SAPPub Web` (UI/API) and `SAPPub Core` (domain logic). These form the SAPPub system boundary.
- External systems: `SAPData` importer (data ingestion), Database (persistent storage), and other external APIs.
- Main interactions: users interact via browser → SAPPub Web → Core → Database; data ingestion runs via `SAPData` into the DB; the project does not include an OAuth/OpenID Connect provider.

Authentication status: there is currently no OAuth/OpenID Connect or external SSO configured in the codebase (no `AddAuthentication` / `UseAuthentication` present in `Program.cs`). If authentication is required later, wire an external IdP or add an auth layer and update this diagram.

Use this file as the canonical System Context diagram and update it when external integrations or actors change.

## Containers (C2)

The container diagram shows the major runnable components (containers) that make up the SAPPub system.

```mermaid
graph LR
	subgraph SAPPub["SAPPub System"]
		Web["SAPPub.Web\n(ASP.NET Core web app)"]
		Core["SAPPub.Core\n(Domain models & services)"]
		Infra["SAPPub.Infrastructure\n(Data access, repositories)"]
		SAPData["SAPData\n(Data generation / ETL tools)"]
		DB[("Postgres Database")]
		ExternalAPI["External Services\n(3rd-party APIs)"]
	end

	Web -->|HTTP / MVC calls| Core
	Core -->|implements interfaces| Infra
	Infra -->|reads/writes| DB
	SAPData -->|imports / seeds| DB
	Web -->|calls| ExternalAPI
	Web -->|serves| Users["End Users (browser)"]

	classDef container fill:#f3f7ff,stroke:#2b8aef;
	class Web,Core,Infra,SAPData container
```

- Purpose: shows what runs where and how data flows between containers.
- Key containers: `SAPPub.Web` (serves UI & server logic), `SAPPub.Core` (business logic), `SAPPub.Infrastructure` (persistence), `SAPData` (data tooling), and the `Postgres` database.

## Components (C3)

The component diagram drills into the primary containers to show major internal components and responsibilities. Below focuses on `SAPPub.Web` and `SAPPub.Core`.

```mermaid
graph TB
	subgraph WebApp["SAPPub.Web (container)"]
		Controllers["Controllers (MVC)\nHandle HTTP endpoints, orchestrate flows"]
		Views["Views & ViewComponents\nUI rendering"]
		Middleware["Middleware\nSecurity headers, routing, custom middleware"]
		Helpers["Helpers / ViewModels / Helpers"]
		Controllers --> Views
		Middleware --> Controllers
		Controllers -->|calls via DI| CoreServices
	end

	subgraph CoreApp["SAPPub.Core (container)"]
		Entities["Entities / Domain Models"]
		Interfaces["Service Interfaces\nContracts used by Web & Infra"]
		Services["Business Services\nImplement domain logic"]
		ReposIface["Repository Interfaces"]
		Services --> Entities
		Services -->|depends on| ReposIface
		Interfaces --> Services
	end

	WebApp --- CoreApp
```

- How to read: Controllers in `SAPPub.Web` implement user-facing endpoints and delegate to `SAPPub.Core` service interfaces. `SAPPub.Infrastructure` provides concrete repository implementations wired into DI at startup.
- Security note: this project currently has no application-level OAuth/OpenID Connect provider configured — authentication is intentionally not present in the codebase.

Update these diagrams as architecture or runtime responsibilities change (e.g., add a background worker, caching layer, or an external auth provider).

